document.addEventListener("alpine:init",()=>{Alpine.store("cart",{cartData:{},cartCounter:0,cartState:{updating:!1},cartCurrency:{iso_code:void 0!==window.currencyVariables?window.currencyVariables.iso_code:null,name:void 0!==window.currencyVariables?window.currencyVariables.name:null,symbol:void 0!==window.currencyVariables?window.currencyVariables.symbol:null,money_format:`${void 0!==window.currencyVariables?window.currencyVariables.symbol:null}{{amount}}`},cartExclusions:[],bundles:[],init(){this.getCartData(),interceptRequests("/cart.json",t=>{this.getCartData(t)}),Alpine.watch(()=>Alpine.store("cart").cartData,this.populateBundles.bind(this)),window.mfrCart=this},async getCartData(t){try{if(this.cartState.updating=!0,t)this.cartData=t;else{const{data:t}=await axios.get("/cart.js",{headers:{Accept:"application/json"}});this.cartData=t}this.cartState.updating=!1,this.cartCounterExclusion(),this.populateBundles();const a=new CustomEvent("cartReady",{detail:{cartData:this.cartData}});document.dispatchEvent(a)}catch(t){return console.error("Failed to fetch cart data:",t),null}},async addToCart(t,a=1,e={},n=null,o=null){try{const i={id:t,quantity:a,properties:e};n&&(i.selling_plan=n);const{data:s}=await axios.post("/cart/add.js",i,{headers:{"Content-Type":"application/json",Accept:"application/json"}});this.getCartData(),"function"==typeof o&&o(s)}catch(t){console.error("Shopify error:",t.response.data)}},async addMultipleToCart(t,a=null){try{const e=[];for(const{id:a,quantity:n=1,properties:o={}}of t){const{data:t}=await axios.post("/cart/add.js",{id:a,quantity:n,properties:o},{headers:{"Content-Type":"application/json",Accept:"application/json"}});e.push(t)}this.getCartData(),"function"==typeof a&&a(e)}catch(t){console.error("Shopify error:",t.response.data)}},async removeToCart(t,a=null){try{const{data:e}=await axios.post("/cart/change.js",{id:t,quantity:0},{headers:{Accept:"application/json","Content-Type":"application/json"}});this.getCartData(),"function"==typeof a&&a(e)}catch(t){console.error("Failed to remove item:",t.response)}},async updateLineItemQuantity(t,a,e=null){try{const{data:n}=await axios.post("/cart/change.js",{id:t,quantity:a},{headers:{Accept:"application/json","Content-Type":"application/json"}});this.getCartData(),"function"==typeof e&&e(n)}catch(t){console.error("Failed to update quantity:",t.response.data)}},async updateLineItemsQuantities(t){try{const{data:a}=await axios.post("/cart/update.js",t,{headers:{Accept:"application/json","Content-Type":"application/json"}});this.getCartData(),"function"==typeof onQuantityUpdate&&onQuantityUpdate(a)}catch(t){console.error("Failed to update quantity:",t.response.data)}},async updateLineItemsQuantities(t){try{const{data:a}=await axios.post("/cart/update.js",t,{headers:{Accept:"application/json","Content-Type":"application/json"}});this.getCartData(),"function"==typeof onQuantityUpdate&&onQuantityUpdate(a)}catch(t){console.error("Failed to update quantity:",t.response.data)}},async updateItemToSellingPlan({key:t,sellingPlanID:a,quantity:e,bundle:n}){this.cartState.updating=!0;const o={id:t,selling_plan:a};if(e&&(o.quantity=e),n&&n.length>1){const t={updates:{}};n.forEach((a,e)=>{0!=e&&(t.updates[a.key]=0)});try{const{data:a}=await axios.post("/cart/update.js",t,{headers:{Accept:"application/json","Content-Type":"application/json"}})}catch(t){console.error("Failed to update to selling plan:",t.response.data)}}try{const{data:t}=await axios.post("/cart/change.js",o,{headers:{Accept:"application/json","Content-Type":"application/json"}});this.cartState.updating=!1,this.getCartData()}catch(t){console.error("Failed to update to selling plan:",t.response.data),this.cartState.updating=!1}},async clearCart(){try{const{data:t}=await axios.post("/cart/clear.js",null,{headers:{Accept:"application/json"}});console.log("Cart cleared:",t),this.getCartData()}catch(t){console.error("Error clearing cart:",t)}},cartCounterExclusion(){if(this.cartExclusions.length<=0)return;const t=this.cartData.items.filter(t=>this.cartExclusions.includes(t.product_type)),a=this.cartData.item_count-t.length;this.cartCounter=a<0?0:a},formatMoney(t){return window.Shopify.formatMoney(t,this.cartCurrency.money_format)},formatSellingplan:t=>t?`${t}`||"":t,incrementQuantity(t,a){this.updateLineItemQuantity(t,a+1)},decrementQuantity(t,a){const e=Math.max(0,a-1);this.updateLineItemQuantity(t,e)},checkIsCartEmpty(){return Array.isArray(this.cartData.items)&&!Boolean(this.cartData.items.length)},checkIsCartNotEmpty(){return!(Array.isArray(this.cartData.items)&&!Boolean(this.cartData.items.length))},populateBundles(){const t=this.cartData.items.filter((t,a)=>t?.properties?._mfr_bundle_hash),a={};t.forEach(t=>{const e=t.properties._mfr_bundle_hash;a[e]||(a[e]=[]),a[e].push(t)});const e=Object.values(a);this.bundles=e??[]}})});
//# sourceMappingURL=mfr-cart.min.js.map

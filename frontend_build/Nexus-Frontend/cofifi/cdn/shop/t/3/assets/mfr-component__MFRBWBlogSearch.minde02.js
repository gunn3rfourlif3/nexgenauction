window._mfrAlpineRegistered=window._mfrAlpineRegistered||{},window._mfrAlpineRegistered.MFRBWBlogSearch||(document.addEventListener("alpine:init",()=>{Alpine.data("MFRBWBlogSearch",e=>({VERSION:"2025-07",API_URL:null,TOKEN:"58186b44f75c0208944765a0a2b4cdb0",QUERY:"\n        query($first:Int!, $after:String, $q:String!, $metafields:[HasMetafieldsIdentifier!]!) {\n          articles(first: $first, after: $after, query: $q, sortKey: PUBLISHED_AT, reverse: true) {\n            edges {\n              cursor\n              node {\n                id\n                handle\n                title\n                blog { handle }\n                tags\n                publishedAt\n                metafields(identifiers: $metafields) {\n                  key\n                  value\n                }\n              }\n            }\n            pageInfo { hasNextPage }\n          }\n        }\n      ",term:"",blogHandle:e,shownArticles:[],hasNext:!1,_nextCursor:null,loading:!1,error:"",pageSize:50,mfKeys:["read_time"],_saved:Object.create(null),metafieldIdentifiers(){return(this.mfKeys&&this.mfKeys.length?this.mfKeys:["nice_title"]).map(e=>({namespace:"mfr_fields",key:e}))},_termKey(){return[(this.blogHandle||"").toLowerCase(),(this.term||"").trim().toLowerCase()].join("|")},_getSaved(e){return this._saved[e]||null},_save(e,t){this._saved[e]=t},init(){this.API_URL=`/api/${this.VERSION}/graphql.json`,this.$watch("term",()=>{this.searchFirstPage()}),this.searchFirstPage()},buildQuery(e,t=""){return[t&&"blog_title:"+(s=t,`"${String(s).replace(/"/g,'\\"')}"`),e?`${e}*`:""].filter(Boolean).join(" ");var s},async sf(e,t={}){const s=await axios.post(this.API_URL,{query:e,variables:t},{headers:{"Content-Type":"application/json","X-Shopify-Storefront-Access-Token":this.TOKEN}}),{data:i,errors:r}=s.data||{};if(r)throw r;return i},async search({append:e=!1}={}){if(!this.loading){this.loading=!0,this.error="";try{const t=this.buildQuery(this.term,this.blogHandle),s=e?this._nextCursor:null,i={first:this.pageSize,after:s,q:t,metafields:this.metafieldIdentifiers()},{articles:r}=await this.sf(this.QUERY,i),n=(r.edges||[]).map(e=>{const t=e.node,s=t.blog?.handle||this.blogHandle||"",i=s?`/blogs/${s}/${t.handle}`:null;let r;return t.metafields&&(r=t.metafields.length&&t.metafields[0]?Object.fromEntries((t.metafields||[]).map(e=>[e.key,e.value])):[]),{...t,url:i,metafields:r}});this._nextCursor=r.edges.at(-1)?.cursor??null,this.hasNext=!!r.pageInfo?.hasNextPage;const a=e?[...this.shownArticles,...n]:n;this.shownArticles=a,this._save(this._termKey(),{nodes:a,nextCursor:this._nextCursor,hasNext:this.hasNext})}catch(e){this.error="Something went wrong loading articles.",console.error(e)}finally{this.loading=!1}}},async searchFirstPage(){if(this._nextCursor=null,this.shownArticles=[],!this.term)return;const e=this._termKey(),t=this._getSaved(e);if(t)return this.shownArticles=t.nodes,this._nextCursor=t.nextCursor,this.hasNext=t.hasNext,void console.log(this.shownArticles);await this.search({append:!1}),console.log(this.shownArticles)},async nextPage(){this.hasNext&&!this.loading&&await this.search({append:!0})}}))}),window._mfrAlpineRegistered.MFRBWBlogSearch=!0);
//# sourceMappingURL=mfr-component__MFRBWBlogSearch.min.js.map

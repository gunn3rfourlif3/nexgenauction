window._mfrAlpineRegistered=window._mfrAlpineRegistered||{},window._mfrAlpineRegistered.MFRBWIngredientsGrid||(document.addEventListener("alpine:init",()=>{Alpine.data("MFRBWIngredientsGrid",({postPerPage:e=1,metaobjectHandle:n="ingredients"})=>({VERSION:"2025-07",API_URL:null,TOKEN:"58186b44f75c0208944765a0a2b4cdb0",QUERY:'\n          query($first:Int!, $after:String, $refs:Int!){\n            metaobjects(type:"ingredients", first:$first, after:$after, sortKey:"updated_at"){\n              edges{\n                cursor\n                node{\n                  id\n                  handle\n                  fields{\n                    key\n                    value\n                    reference{\n                      __typename\n                      ... on MediaImage { image { url altText width height } }\n                      ... on GenericFile { url }\n                      ... on Product {\n                        id handle title\n                        onlineStoreUrl\n                        metafield(namespace:"mfr_fields", key:"nice_title"){ value }\n                      }\n                    }\n                    references(first:$refs){\n                      edges{\n                        node{\n                          __typename\n                          ... on MediaImage { image { url altText width height } }\n                          ... on GenericFile { url }\n                          ... on Product {\n                            id handle title\n                            onlineStoreUrl\n                            metafield(namespace:"mfr_fields", key:"nice_title"){ value }\n                          }\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n              pageInfo{ hasNextPage }\n            }\n          }\n        ',shownIngredients:[],postPerPage:e,page:1,hasNext:!1,searchTerm:null,activeProductHandle:"",noResult:!1,init(){this.API_URL=`/api/${this.VERSION}/graphql.json`,this.fetchIngredients()},fetchIngredients(e=!0){this.getIngredients({pageSize:this.postPerPage,page:this.page,q:this.searchTerm??"",productHandles:this.activeProductHandle?[this.activeProductHandle]:[]}).then(n=>{n.items.length?(this.noResult=!1,this.shownIngredients=e?[...this.shownIngredients,...n.items]:n.items):this.noResult=!0,this.hasNext=n.hasNext,ScrollTrigger&&ScrollTrigger.refresh&&ScrollTrigger.refresh()})},async sf(e,n={}){const t=await fetch(this.API_URL,{method:"POST",headers:{"Content-Type":"application/json","X-Shopify-Storefront-Access-Token":this.TOKEN},body:JSON.stringify({query:e,variables:n})}),r=await t.json();if(r.errors)throw r.errors;return r.data},matches(e,{q:n="",ids:t=[],handles:r=[],key:i="reference_product"}={}){const s=Object.fromEntries((e.fields||[]).map(e=>[e.key,e])),a=[...(s[i]?.references?.edges||[]).map(e=>e.node),...s[i]?.reference?[s[i].reference]:[]].filter(e=>"Product"===e?.__typename),d=(n||"").trim().toLowerCase(),o=!d||(s.name?.value||"").toLowerCase().includes(d)||(s.short_description?.value||"").toLowerCase().includes(d)||a.some(e=>(e.title||"").toLowerCase().includes(d)||(e.metafield?.value||"").toLowerCase().includes(d)),l=!t.length&&!r.length||a.some(e=>t.includes(e.id)||r.includes(e.handle));return o&&l},async getIngredients({pageSize:e=12,page:n=1,q:t="",productIds:r=[],productHandles:i=[],fieldKey:s="reference_product"}={}){e=Math.min(50,Math.max(1,Number(e)||12));const a=(n=Math.max(1,Number(n)||1))*e+1,d=[];let o=null,l=!0;for(;l&&d.length<a;){const{metaobjects:e}=await this.sf(this.QUERY,{first:50,after:o,refs:50}),n=e?.edges||[];for(const e of n)if(this.matches(e.node,{q:t,ids:r,handles:i,key:s})&&(d.push(e.node),d.length>=a))break;if(l=!!e?.pageInfo?.hasNextPage,o=n.at(-1)?.cursor||null,!n.length)break}const c=(n-1)*e;return{items:d.slice(c,c+e).map(e=>{const n=Object.fromEntries((e.fields||[]).map(e=>[e.key,e])),t=n.card_image?.reference||n.card_image?.references?.edges?.[0]?.node||null,r=t?.image,i=[...(n[s]?.references?.edges||[]).map(e=>e.node),...n[s]?.reference?[n[s].reference]:[]].filter(e=>"Product"===e?.__typename).map(e=>e);return{id:e.id,handle:e.handle,name:n.name?.value??null,image:r,short_description:n.short_description?.value??null,products:i}}),hasNext:d.length>n*e,page:n,pageSize:e}}}))}),window._mfrAlpineRegistered.MFRBWIngredientsGrid=!0);
//# sourceMappingURL=mfr-component__MFRBWIngredientsGrid.min.js.map
